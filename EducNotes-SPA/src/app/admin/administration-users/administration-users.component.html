<div class="card">
    <form nz-form [nzLayout]="'inline'" #searchForm="ngForm" class="ml-3">
       
        <nz-form-item>
            <nz-form-label nzRequired nzFor="classId">Type de compte</nz-form-label>
            <nz-form-control  >
                <nz-select  style="width: 150px" nzAllowClear nzShowSearch nzPlaceHolder="Choisir le type" name="typeId" [(ngModel)]="typeId">
                    <nz-option *ngFor="let option of userTypes" [nzValue]="option.id" [nzLabel]="option.name"></nz-option>
                    </nz-select>
            </nz-form-control>
            <nz-form-control>
                <button nz-button nzType="default" [disabled]="!typeId" class="ml-3" (click)="search()">rechercher</button>
                <button nz-button nzType="primary"  class="ml-1" (click)="add()">ajouter</button>
              </nz-form-control>
        </nz-form-item>
       
      </form>
</div>

<div class="card mt-3" >
    <nz-alert *ngIf="noResult"
    nzType="warning"
    nzMessage="Information"
    nzDescription="{{noResult}}"
    nzShowIcon>
  </nz-alert>

      <nz-table #basicTable [nzData]="users" [nzPageSize]="10" [nzBordered]="true" [nzSize]="'small'"  *ngIf="users.length > 0">
          <thead>
            <tr>
                <th>Nom Complet</th>
                <th>Contact(s)</th>
                <th>Email</th>
                <th>option</th>
            </tr>
          </thead>
          <tbody>
              <tr *ngFor="let user of users">
                  <td> <img src="{{user.photoUrl || '../../assets/user.png'}}" class="rounded-circle" alt="">{{user.lastName}} {{user.firstName}}</td>
                  <td> {{user.phoneNumber}} <span *ngIf="user.secondPhoneNumber">- {{user.secondPhoneNumber}}</span></td>
                  <td> {{user.email}}</td>
                  <td> 
                     <button nz-button nzType="default" (click)="updatingUser(user)"> <i class="fa fa-edit"></i> </button>
                    <button nz-button nzType="default" (click)="deleteUser(user.id)" class="ml-2" [disabled]="user.emailConfirmed == false"> <i class="fa fa-trash-o"></i> </button>
                  
                  </td>
                </tr>
          </tbody>
        </nz-table>

 
</div>
<nz-drawer [nzBodyStyle]="{ height: 'calc(100% - 55px)', overflow: 'auto', 'padding-bottom':'53px' }"[nzMaskClosable]="false" [nzWidth]="720" [nzVisible]="visible" nzTitle="{{drawerTitle}}" (nzOnClose)="close()">
    <div>
        <form nz-form [formGroup]="userForm" (ngSubmit)="submit()">
            <div nz-row nzGutter="8">
              <div nz-col nzSpan="12">
                <nz-form-item>
                  <nz-form-label>Nom </nz-form-label>
                  <nz-form-control>
                    <input nz-input placeholder="entrer le nom de l'enfant" formControlName="lastName" id="clastName" >
                  </nz-form-control>
                </nz-form-item>
              </div>
              <div nz-col nzSpan="12">
                  <nz-form-item>
                    <nz-form-label>Prénom(s)</nz-form-label>
                    <nz-form-control>
                      <input nz-input placeholder="entrer le prénom(s) de l'enfant" formControlName="firstName" id="cfirstName">
                    </nz-form-control>
                  </nz-form-item>
                </div>
        
           
            </div>
            <div nz-row nzGutter="8">
                <div nz-col nzSpan="12">
                  <nz-form-item>
                    <nz-form-label>Type de compte </nz-form-label>
                   
                    <nz-form-control  >
                        <nz-select   nzAllowClear nzShowSearch nzPlaceHolder="Choisir le type" name="typeId" formControlName="userTypeId">
                            <nz-option *ngFor="let option of userTypes" [nzValue]="option.id" [nzLabel]="option.name"></nz-option>
                            </nz-select>
                    </nz-form-control>
                  </nz-form-item>
                </div>
                <div nz-col nzSpan="12">
                    <nz-form-item>
                      <nz-form-label>Sexe</nz-form-label>
                      <nz-form-control  >
                          <nz-select   nzAllowClear nzShowSearch nzPlaceHolder="Choisir le type" name="typeId" formControlName="gender">
                              <nz-option *ngFor="let option of sexe" [nzValue]="option.id" [nzLabel]="option.name"></nz-option>
                              </nz-select>
                      </nz-form-control>
                    </nz-form-item>
                  </div>
          
             
              </div>
            <div nz-row nzGutter="8">
              <div nz-col nzSpan="12">
                  <nz-form-item>
                      <nz-form-label  nzRequired nzFor="dateOfBirth">Date de naissance</nz-form-label>
                      <nz-form-control [nzValidateStatus]="userForm.controls['dateOfBirth']">
                          <nz-date-picker formControlName="dateOfBirth" id="datenaiss" [nzFormat]="'dd-MMMM-yyyy'"></nz-date-picker>
                      </nz-form-control>
                    </nz-form-item>
              </div>
              <div nz-col nzSpan="12">
                <nz-form-item>
                    <nz-form-label >Email</nz-form-label>
                    <nz-form-control  [nzValidateStatus]="userForm.controls['email']">
                      <nz-input-group nzAddOnBefore="@">
                        <input type="text" nz-input placeholder="email" formControlName="email" id="cemail">
                    <nz-form-explain *ngIf="userForm.get('email').touched && userForm.get('email').errors">Entrer un email valide!</nz-form-explain>
                      </nz-input-group>
                    </nz-form-control>
                </nz-form-item>
            </div>
            
            </div>
             <div nz-row nzGutter="8">
              <div nz-col nzSpan="12">
                <nz-form-item>
                    <nz-form-label nzRequired nzFor="phoneNumber">Contact Principal</nz-form-label>
                    <nz-form-control [nzValidateStatus]="userForm.controls['phoneNumber']">
                        <input nz-input placeholder="numero principal" formControlName="phoneNumber" id="cphoneNumber" pattern="[0-9]+" minlength="8">
                        <nz-form-explain *ngIf="userForm.get('phoneNumber').touched && userForm.get('phoneNumber').errors">Entrer un numéro de téléphone valide s'il vous plait!</nz-form-explain>
                      </nz-form-control>
                  </nz-form-item>
              </div>
              <div nz-col nzSpan="12">
                  <nz-form-item>
                      <nz-form-label>Deuxieme Contact</nz-form-label>
                      <nz-form-control  [nzValidateStatus]="userForm.controls['secondPhoneNumber']">
                          <input nz-input placeholder="autre numero" formControlName="secondPhoneNumber" id="sphoneNumber" pattern="[0-9]+" minlength="8">
                          <nz-form-explain *ngIf="userForm.get('secondPhoneNumber').touched && userForm.get('secondPhoneNumber').errors">numero nom valide!</nz-form-explain>
                        </nz-form-control>
                </nz-form-item>
                </div>
              <div nz-col nzSpan="12">
               
              </div>
            </div>
           
           
            
         </form>
          <div class="footer mt-4">
              <button type="submit" [disabled]="!userForm.valid || submitText!='enregistrer'" (click)="submit()" class="ant-btn ant-btn-primary"><span>{{submitText}}</span></button>
              <button type="button" (click)="close()" class="ant-btn" style="margin-right: 8px;"><span>annuler</span></button>
          </div>
    </div>
    
 </nz-drawer>